# Data Model: Book-Based Chatbot

## Entities

### Book Content
- **Description**: Represents the source material that the chatbot uses to answer questions
- **Fields**:
  - text: string (the actual content)
  - url: string (source URL)
  - chunk_id: integer (identifier for the chunk)
  - embedding: vector (Cohere embedding of the text)
- **Relationships**: Belongs to a Collection in Qdrant
- **Validation**: Text must not be empty

### User Query
- **Description**: Represents a question or request submitted by the user
- **Fields**:
  - query_text: string (the user's question)
  - user_id: string (identifier for the user)
  - timestamp: datetime (when the query was made)
- **Validation**: Query text must not be empty

### Chat Response
- **Description**: Represents the answer generated by the system
- **Fields**:
  - response_text: string (the AI-generated answer)
  - sources: array of SourceReference objects (where the information came from)
  - session_id: string (identifier for the conversation session)
  - timestamp: string (when the response was generated)
- **Validation**: Response text must not be empty

### Source Reference
- **Description**: Represents a reference to the book content that supports the response
- **Fields**:
  - module: string (the module/chapter identifier)
  - chapter: string (the chapter title)
  - section: string (the section identifier)
  - content: string (the actual text content)
  - similarity_score: float (how relevant this content is to the query)
- **Validation**: Similarity score must be between 0 and 1

### Vector Embeddings
- **Description**: Represents the indexed representation of book content in the Qdrant database
- **Fields**:
  - id: integer (unique identifier)
  - vector: array of floats (the embedding vector)
  - payload: object containing text, url, and chunk_id
- **Validation**: Vector must have correct dimensions (1024 for Cohere embed-english-v3.0)

## State Transitions

### Chat Session
- **Initial State**: Created when user starts conversation
- **Active State**: When user sends queries and receives responses
- **Ended State**: When session is completed or times out

## Relationships
- Book Content is stored in Qdrant collections
- User Query is processed against Book Content via vector similarity
- Chat Response contains references to Source Reference objects
- Source Reference points back to specific Book Content chunks